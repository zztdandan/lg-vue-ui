{"version":3,"sources":["webpack:///./packages/lg-export-excel/src/Export2Excel.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js?4c6f","webpack:///./node_modules/script-loader/addScript.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js"],"names":["export_json_to_excel","_ref","arguments","length","undefined","header","data","filename","_ref$autoWidth","autoWidth","_ref$bookType","bookType","unshift","wb","Workbook","this","SheetNames","Sheets","ws","opts","range","s","c","r","e","R","C","cell","v","cell_ref","XLSX","utils","encode_cell","t","Date","z","SSF","_table","datenum","encode_range","sheet_from_array_of_arrays","colWidth","map","row","val","wch","toString","charCodeAt","result","i","j","push","wbout","write","bookSST","type","saveAs","Blob","buf","ArrayBuffer","view","Uint8Array","s2ab","_xlsx","__webpack_require__","require","module","exports","src","log","error","console","execScript","attachEvent","addEventListener","eval","call"],"mappings":"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","file":"0.lgui.min.js","sourcesContent":["/* eslint-disable */\nrequire('script-loader!file-saver');\nimport XLSX from 'xlsx'\n\nfunction sheet_from_array_of_arrays(data, opts) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n      var cell = {\n        v: data[R][C]\n      };\n      if (cell.v == null) continue;\n      var cell_ref = XLSX.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') cell.t = 'n';\n      else if (typeof cell.v === 'boolean') cell.t = 'b';\n      else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = XLSX.SSF._table[14];\n        cell.v = datenum(cell.v);\n      } else cell.t = 's';\n\n      ws[cell_ref] = cell;\n    }\n  }\n  if (range.s.c < 10000000) ws['!ref'] = XLSX.utils.encode_range(range);\n  return ws;\n}\n\nfunction Workbook() {\n  if (!(this instanceof Workbook)) return new Workbook();\n  this.SheetNames = [];\n  this.Sheets = {};\n}\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n  return buf;\n}\n\nexport function export_json_to_excel({\n  header,\n  data,\n  filename,\n  autoWidth = true,\n  bookType=  'xlsx'\n} = {}) {\n  /* original data */\n  filename = filename || 'excel-list'\n  data = [...data]\n  data.unshift(header);\n  var ws_name = \"SheetJS\";\n  var wb = new Workbook(),\n    ws = sheet_from_array_of_arrays(data);\n\n  if (autoWidth) {\n    /*设置worksheet每列的最大宽度*/\n    const colWidth = data.map(row => row.map(val => {\n      /*先判断是否为null/undefined*/\n      if (val == null) {\n        return {\n          'wch': 10\n        };\n      }\n      /*再判断是否为中文*/\n      else if (val.toString().charCodeAt(0) > 255) {\n        return {\n          'wch': val.toString().length * 2\n        };\n      } else {\n        return {\n          'wch': val.toString().length\n        };\n      }\n    }))\n    /*以第一行为初始值*/\n    let result = colWidth[0];\n    for (let i = 1; i < colWidth.length; i++) {\n      for (let j = 0; j < colWidth[i].length; j++) {\n        if (result[j]['wch'] < colWidth[i][j]['wch']) {\n          result[j]['wch'] = colWidth[i][j]['wch'];\n        }\n      }\n    }\n    ws['!cols'] = result;\n  }\n\n  /* add worksheet to workbook */\n  wb.SheetNames.push(ws_name);\n  wb.Sheets[ws_name] = ws;\n\n  var wbout = XLSX.write(wb, {\n    bookType: bookType,\n    bookSST: false,\n    type: 'binary'\n  });\n  saveAs(new Blob([s2ab(wbout)], {\n    type: \"application/octet-stream\"\n  }), `${filename}.${bookType}`);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/lg-export-excel/src/Export2Excel.js","require(\"!!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\script-loader\\\\addScript.js\")(require(\"!!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\raw-loader\\\\index.js!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\file-saver\\\\dist\\\\FileSaver.min.js\"))\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/script-loader!./node_modules/file-saver/dist/FileSaver.min.js\n// module id = 159\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nmodule.exports = function(src) {\n\tfunction log(error) {\n\t\t(typeof console !== \"undefined\")\n\t\t&& (console.error || console.log)(\"[Script Loader]\", error);\n\t}\n\n\t// Check for IE =< 8\n\tfunction isIE() {\n\t\treturn typeof attachEvent !== \"undefined\" && typeof addEventListener === \"undefined\";\n\t}\n\n\ttry {\n\t\tif (typeof execScript !== \"undefined\" && isIE()) {\n\t\t\texecScript(src);\n\t\t} else if (typeof eval !== \"undefined\") {\n\t\t\teval.call(null, src);\n\t\t} else {\n\t\t\tlog(\"EvalError: No eval function available\");\n\t\t}\n\t} catch (error) {\n\t\tlog(error);\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/script-loader/addScript.js\n// module id = 160\n// module chunks = 0","module.exports = \"(function(a,b){if(\\\"function\\\"==typeof define&&define.amd)define([],b);else if(\\\"undefined\\\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\\\"use strict\\\";function b(a,b){return\\\"undefined\\\"==typeof b?b={autoBom:!1}:\\\"object\\\"!=typeof b&&(console.warn(\\\"Depricated: Expected third argument to be a object\\\"),b={autoBom:!b}),b.autoBom&&/^\\\\s*(?:text\\\\/\\\\S*|application\\\\/xml|\\\\S*\\\\/\\\\S*\\\\+xml)\\\\s*;.*charset\\\\s*=\\\\s*utf-8/i.test(a.type)?new Blob([\\\"\\\\uFEFF\\\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\\\"GET\\\",b),e.responseType=\\\"blob\\\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\\\"could not download file\\\")},e.send()}function d(a){var b=new XMLHttpRequest;return b.open(\\\"HEAD\\\",a,!1),b.send(),200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\\\"click\\\"))}catch(c){var b=document.createEvent(\\\"MouseEvents\\\");b.initMouseEvent(\\\"click\\\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\\\"object\\\"==typeof window&&window.window===window?window:\\\"object\\\"==typeof self&&self.self===self?self:\\\"object\\\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||\\\"object\\\"!=typeof window||window!==f?function(){}:\\\"download\\\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\\\"a\\\");g=g||b.name||\\\"download\\\",j.download=g,j.rel=\\\"noopener\\\",\\\"string\\\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\\\"_blank\\\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\\\"msSaveOrOpenBlob\\\"in navigator?function(f,g,h){if(g=g||f.name||\\\"download\\\",\\\"string\\\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\\\"a\\\");i.href=f,i.target=\\\"_blank\\\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\\\"\\\",\\\"_blank\\\"),e&&(e.document.title=e.document.body.innerText=\\\"downloading...\\\"),\\\"string\\\"==typeof a)return c(a,b,d);var g=\\\"application/octet-stream\\\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\\\/[\\\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\\\"object\\\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\\\"data:attachment/file;\\\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}};f.saveAs=a.saveAs=a,\\\"undefined\\\"!=typeof module&&(module.exports=a)});\\n\\n//# sourceMappingURL=FileSaver.min.js.map\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/raw-loader!./node_modules/file-saver/dist/FileSaver.min.js\n// module id = 161\n// module chunks = 0"],"sourceRoot":""}