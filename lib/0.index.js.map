{"version":3,"sources":["webpack:///./packages/lg-export-excel/src/Export2Excel.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js?4c6f","webpack:///./node_modules/script-loader/addScript.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js"],"names":["export_table_to_excel","id","oo","table","out","rows","querySelectorAll","ranges","R","length","outRow","row","columns","C","cell","colspan","getAttribute","rowspan","cellValue","innerText","forEach","range","s","r","e","c","i","push","k","generateArray","document","getElementById","data","wb","Workbook","ws","sheet_from_array_of_arrays","SheetNames","Sheets","wbout","XLSX","write","bookType","bookSST","type","saveAs","Blob","s2ab","export_json_to_excel","_ref","arguments","undefined","header","filename","_ref$autoWidth","autoWidth","_ref$bookType","unshift","colWidth","map","val","wch","toString","charCodeAt","result","j","_xlsx","__webpack_require__","opts","v","cell_ref","utils","encode_cell","t","Date","z","SSF","_table","datenum","parse","UTC","encode_range","this","buf","ArrayBuffer","view","Uint8Array","require","module","exports","src","log","error","console","execScript","attachEvent","addEventListener","eval","call"],"mappings":"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","file":"0.index.js","sourcesContent":["/* eslint-disable */\nrequire('script-loader!file-saver');\nimport XLSX from 'xlsx'\n\nfunction generateArray(table) {\n  var out = [];\n  var rows = table.querySelectorAll('tr');\n  var ranges = [];\n  for (var R = 0; R < rows.length; ++R) {\n    var outRow = [];\n    var row = rows[R];\n    var columns = row.querySelectorAll('td');\n    for (var C = 0; C < columns.length; ++C) {\n      var cell = columns[C];\n      var colspan = cell.getAttribute('colspan');\n      var rowspan = cell.getAttribute('rowspan');\n      var cellValue = cell.innerText;\n      if (cellValue !== \"\" && cellValue == +cellValue) cellValue = +cellValue;\n\n      //Skip ranges\n      ranges.forEach(function (range) {\n        if (R >= range.s.r && R <= range.e.r && outRow.length >= range.s.c && outRow.length <= range.e.c) {\n          for (var i = 0; i <= range.e.c - range.s.c; ++i) outRow.push(null);\n        }\n      });\n\n      //Handle Row Span\n      if (rowspan || colspan) {\n        rowspan = rowspan || 1;\n        colspan = colspan || 1;\n        ranges.push({\n          s: {\n            r: R,\n            c: outRow.length\n          },\n          e: {\n            r: R + rowspan - 1,\n            c: outRow.length + colspan - 1\n          }\n        });\n      };\n\n      //Handle Value\n      outRow.push(cellValue !== \"\" ? cellValue : null);\n\n      //Handle Colspan\n      if (colspan)\n        for (var k = 0; k < colspan - 1; ++k) outRow.push(null);\n    }\n    out.push(outRow);\n  }\n  return [out, ranges];\n};\n\nfunction datenum(v, date1904) {\n  if (date1904) v += 1462;\n  var epoch = Date.parse(v);\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n}\n\nfunction sheet_from_array_of_arrays(data, opts) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n      var cell = {\n        v: data[R][C]\n      };\n      if (cell.v == null) continue;\n      var cell_ref = XLSX.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') cell.t = 'n';\n      else if (typeof cell.v === 'boolean') cell.t = 'b';\n      else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = XLSX.SSF._table[14];\n        cell.v = datenum(cell.v);\n      } else cell.t = 's';\n\n      ws[cell_ref] = cell;\n    }\n  }\n  if (range.s.c < 10000000) ws['!ref'] = XLSX.utils.encode_range(range);\n  return ws;\n}\n\nfunction Workbook() {\n  if (!(this instanceof Workbook)) return new Workbook();\n  this.SheetNames = [];\n  this.Sheets = {};\n}\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n  return buf;\n}\n\nexport function export_table_to_excel(id) {\n  var theTable = document.getElementById(id);\n  var oo = generateArray(theTable);\n  var ranges = oo[1];\n\n  /* original data */\n  var data = oo[0];\n  var ws_name = \"SheetJS\";\n\n  var wb = new Workbook(),\n    ws = sheet_from_array_of_arrays(data);\n\n  /* add ranges to worksheet */\n  // ws['!cols'] = ['apple', 'banan'];\n  ws['!merges'] = ranges;\n\n  /* add worksheet to workbook */\n  wb.SheetNames.push(ws_name);\n  wb.Sheets[ws_name] = ws;\n\n  var wbout = XLSX.write(wb, {\n    bookType: 'xlsx',\n    bookSST: false,\n    type: 'binary'\n  });\n\n  saveAs(new Blob([s2ab(wbout)], {\n    type: \"application/octet-stream\"\n  }), \"test.xlsx\")\n}\n\nexport function export_json_to_excel({\n  header,\n  data,\n  filename,\n  autoWidth = true,\n  bookType=  'xlsx'\n} = {}) {\n  /* original data */\n  filename = filename || 'excel-list'\n  data = [...data]\n  data.unshift(header);\n  var ws_name = \"SheetJS\";\n  var wb = new Workbook(),\n    ws = sheet_from_array_of_arrays(data);\n\n  if (autoWidth) {\n    /*设置worksheet每列的最大宽度*/\n    const colWidth = data.map(row => row.map(val => {\n      /*先判断是否为null/undefined*/\n      if (val == null) {\n        return {\n          'wch': 10\n        };\n      }\n      /*再判断是否为中文*/\n      else if (val.toString().charCodeAt(0) > 255) {\n        return {\n          'wch': val.toString().length * 2\n        };\n      } else {\n        return {\n          'wch': val.toString().length\n        };\n      }\n    }))\n    /*以第一行为初始值*/\n    let result = colWidth[0];\n    for (let i = 1; i < colWidth.length; i++) {\n      for (let j = 0; j < colWidth[i].length; j++) {\n        if (result[j]['wch'] < colWidth[i][j]['wch']) {\n          result[j]['wch'] = colWidth[i][j]['wch'];\n        }\n      }\n    }\n    ws['!cols'] = result;\n  }\n\n  /* add worksheet to workbook */\n  wb.SheetNames.push(ws_name);\n  wb.Sheets[ws_name] = ws;\n\n  var wbout = XLSX.write(wb, {\n    bookType: bookType,\n    bookSST: false,\n    type: 'binary'\n  });\n  saveAs(new Blob([s2ab(wbout)], {\n    type: \"application/octet-stream\"\n  }), `${filename}.${bookType}`);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./packages/lg-export-excel/src/Export2Excel.js","require(\"!!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\script-loader\\\\addScript.js\")(require(\"!!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\raw-loader\\\\index.js!E:\\\\GitFiles\\\\lg\\\\lg-vue-ui\\\\node_modules\\\\file-saver\\\\dist\\\\FileSaver.min.js\"))\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/script-loader!./node_modules/file-saver/dist/FileSaver.min.js\n// module id = 148\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nmodule.exports = function(src) {\n\tfunction log(error) {\n\t\t(typeof console !== \"undefined\")\n\t\t&& (console.error || console.log)(\"[Script Loader]\", error);\n\t}\n\n\t// Check for IE =< 8\n\tfunction isIE() {\n\t\treturn typeof attachEvent !== \"undefined\" && typeof addEventListener === \"undefined\";\n\t}\n\n\ttry {\n\t\tif (typeof execScript !== \"undefined\" && isIE()) {\n\t\t\texecScript(src);\n\t\t} else if (typeof eval !== \"undefined\") {\n\t\t\teval.call(null, src);\n\t\t} else {\n\t\t\tlog(\"EvalError: No eval function available\");\n\t\t}\n\t} catch (error) {\n\t\tlog(error);\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/script-loader/addScript.js\n// module id = 149\n// module chunks = 0","module.exports = \"(function(a,b){if(\\\"function\\\"==typeof define&&define.amd)define([],b);else if(\\\"undefined\\\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\\\"use strict\\\";function b(a,b){return\\\"undefined\\\"==typeof b?b={autoBom:!1}:\\\"object\\\"!=typeof b&&(console.warn(\\\"Depricated: Expected third argument to be a object\\\"),b={autoBom:!b}),b.autoBom&&/^\\\\s*(?:text\\\\/\\\\S*|application\\\\/xml|\\\\S*\\\\/\\\\S*\\\\+xml)\\\\s*;.*charset\\\\s*=\\\\s*utf-8/i.test(a.type)?new Blob([\\\"\\\\uFEFF\\\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\\\"GET\\\",b),e.responseType=\\\"blob\\\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\\\"could not download file\\\")},e.send()}function d(a){var b=new XMLHttpRequest;return b.open(\\\"HEAD\\\",a,!1),b.send(),200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\\\"click\\\"))}catch(c){var b=document.createEvent(\\\"MouseEvents\\\");b.initMouseEvent(\\\"click\\\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\\\"object\\\"==typeof window&&window.window===window?window:\\\"object\\\"==typeof self&&self.self===self?self:\\\"object\\\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||\\\"object\\\"!=typeof window||window!==f?function(){}:\\\"download\\\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\\\"a\\\");g=g||b.name||\\\"download\\\",j.download=g,j.rel=\\\"noopener\\\",\\\"string\\\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\\\"_blank\\\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\\\"msSaveOrOpenBlob\\\"in navigator?function(f,g,h){if(g=g||f.name||\\\"download\\\",\\\"string\\\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\\\"a\\\");i.href=f,i.target=\\\"_blank\\\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\\\"\\\",\\\"_blank\\\"),e&&(e.document.title=e.document.body.innerText=\\\"downloading...\\\"),\\\"string\\\"==typeof a)return c(a,b,d);var g=\\\"application/octet-stream\\\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\\\/[\\\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\\\"object\\\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\\\"data:attachment/file;\\\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}};f.saveAs=a.saveAs=a,\\\"undefined\\\"!=typeof module&&(module.exports=a)});\\n\\n//# sourceMappingURL=FileSaver.min.js.map\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/raw-loader!./node_modules/file-saver/dist/FileSaver.min.js\n// module id = 150\n// module chunks = 0"],"sourceRoot":""}